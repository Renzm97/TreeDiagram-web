# æ ‘å½¢å›¾ç”Ÿæˆå™¨ (TreeDiagram Web)

ä¸€ä¸ªåŸºäºFastAPIå’Œç°ä»£å‰ç«¯æŠ€æœ¯çš„æ ‘å½¢å›¾è‡ªåŠ¨ç”Ÿæˆå·¥å…·ï¼Œæ”¯æŒå°†ç»“æ„åŒ–æ•°æ®è½¬æ¢ä¸ºç¾è§‚çš„æ ‘å½¢å›¾å¹¶å¯¼å‡ºä¸ºJPG/SVGæ ¼å¼ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸŒ³ **è‡ªåŠ¨æ ‘å½¢å›¾ç”Ÿæˆ**: æ ¹æ®ç»“æ„åŒ–JSONæ•°æ®è‡ªåŠ¨ç”Ÿæˆæ ‘å½¢å›¾
- ğŸ¨ **ç¾è§‚çš„UIè®¾è®¡**: è“è‰²æ–¹å½¢èŠ‚ç‚¹ï¼ˆéå¶å­èŠ‚ç‚¹ï¼‰å’Œåœ†å½¢èŠ‚ç‚¹ï¼ˆå¶å­èŠ‚ç‚¹ï¼‰
- ğŸ”— **å…³ç³»æ ‡è¯†**: æ”¯æŒAND/ORå…³ç³»è¿æ¥æ ‡è¯†
- ğŸ“± **å“åº”å¼è®¾è®¡**: é€‚é…ä¸åŒå±å¹•å°ºå¯¸
- ğŸ’¾ **å¤šæ ¼å¼å¯¼å‡º**: æ”¯æŒJPGå’ŒSVGæ ¼å¼ä¿å­˜
- ğŸš€ **å®æ—¶é¢„è§ˆ**: åœ¨æµè§ˆå™¨ä¸­å®æ—¶æŸ¥çœ‹ç”Ÿæˆçš„æ ‘å½¢å›¾
- ğŸ§ª **å®Œæ•´æµ‹è¯•**: åŒ…å«å•å…ƒæµ‹è¯•å’ŒAPIæµ‹è¯•

## é¡¹ç›®ç»“æ„

```
TreeDiagram-web/
â”œâ”€â”€ app/                    # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py            # FastAPIä¸»åº”ç”¨
â”‚   â”œâ”€â”€ models.py          # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ tree_generator.py  # æ ‘å½¢å›¾ç”Ÿæˆå™¨
â”œâ”€â”€ web/                   # å‰ç«¯ä»£ç 
â”‚   â””â”€â”€ templates/
â”‚       â””â”€â”€ index.html     # ä¸»é¡µé¢æ¨¡æ¿
â”œâ”€â”€ workspace/             # ç”Ÿæˆçš„å›¾ç‰‡ä¿å­˜ç›®å½•
â”œâ”€â”€ requirements.txt       # ä¾èµ–åŒ…
â”œâ”€â”€ run_api.py            # ç¨‹åºå…¥å£
â””â”€â”€ README.md             # é¡¹ç›®è¯´æ˜
```

## å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå’Œå®‰è£…ä¾èµ–

```bash
uv venv
.venv\Scripts\activate
uv pip install -r requirements.txt
```

### 2. å¯åŠ¨æœåŠ¡

```bash
python run_api.py
```

æœåŠ¡å°†åœ¨ `http://127.0.0.1:8000` å¯åŠ¨ã€‚

### 3. è®¿é—®åº”ç”¨

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://127.0.0.1:8000`ï¼Œå³å¯çœ‹åˆ°æ ‘å½¢å›¾ç”Ÿæˆå™¨ç•Œé¢ã€‚

## æ•°æ®æ ¼å¼

### JSONæ•°æ®ç»“æ„

```json
{
  "name": "èŠ‚ç‚¹åç§°",
  "children": [
    {
      "name": "å­èŠ‚ç‚¹1",
      "is_leaf": true
    },
    {
      "name": "å­èŠ‚ç‚¹2",
      "children": [...],
      "relation_type": "and"
    }
  ],
  "relation_type": "or"
}
```

### å­—æ®µè¯´æ˜

- `name`: èŠ‚ç‚¹æ˜¾ç¤ºåç§°ï¼ˆå¿…å¡«ï¼‰
- `children`: å­èŠ‚ç‚¹æ•°ç»„ï¼ˆå¯é€‰ï¼‰
- `relation_type`: å…³ç³»ç±»å‹ï¼Œå¯é€‰å€¼ï¼š"and"ã€"or"
- `is_leaf`: æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹ï¼ˆå¯é€‰ï¼Œé»˜è®¤æ ¹æ®æ˜¯å¦æœ‰å­èŠ‚ç‚¹åˆ¤æ–­ï¼‰

### ç¤ºä¾‹æ•°æ®

```json
{
  "name": "æ™ºèƒ½è¿è¥ç•Œé¢",
  "children": [
    {
      "name": "æ•°æ®ç•Œé¢",
      "children": [
        {
          "name": "æ•°æ®ç»Ÿè®¡",
          "is_leaf": true
        },
        {
          "name": "åˆ†ææŠ¥å‘Š",
          "is_leaf": true
        }
      ],
      "relation_type": "and"
    },
    {
      "name": "æœºå™¨è¿æ¥ç•Œé¢",
      "children": [
        {
          "name": "è¿æ¥çŠ¶æ€",
          "is_leaf": true
        },
        {
          "name": "è®¾å¤‡ç›‘æ§",
          "is_leaf": true
        }
      ],
      "relation_type": "or"
    }
  ],
  "relation_type": "or"
}
```

## APIæ¥å£

### ç”Ÿæˆæ ‘å½¢å›¾

**POST** `/api/generate-tree`

è¯·æ±‚ä½“ï¼š
```json
{
  "root_node": {
    "name": "æ ¹èŠ‚ç‚¹",
    "children": [...],
    "relation_type": "or"
  }
}
```

å“åº”ï¼š
```json
{
  "success": true,
  "message": "æ ‘å½¢å›¾ç”ŸæˆæˆåŠŸ",
  "image_path": "tree_diagram_20231201_143022.html"
}
```

### è·å–ç”Ÿæˆçš„HTML

**GET** `/api/tree-html/{filename}`

### å¥åº·æ£€æŸ¥

**GET** `/api/health`

## è¿è¡Œæµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
# APIæµ‹è¯•
python test/test_api.py

# å•å…ƒæµ‹è¯•
python test/test_tree_generator.py
```

### ä½¿ç”¨pytestè¿è¡Œæµ‹è¯•

```bash
pip install pytest
pytest test/
```

## æŠ€æœ¯æ ˆ

### åç«¯
- **FastAPI**: ç°ä»£Python Webæ¡†æ¶
- **Pydantic**: æ•°æ®éªŒè¯å’Œè®¾ç½®ç®¡ç†
- **Uvicorn**: ASGIæœåŠ¡å™¨

### å‰ç«¯
- **HTML5/CSS3**: ç°ä»£Webæ ‡å‡†
- **JavaScript**: åŸç”ŸJSï¼Œæ— éœ€æ¡†æ¶ä¾èµ–
- **SVG**: çŸ¢é‡å›¾å½¢ç”Ÿæˆ

### å…¶ä»–
- **Jinja2**: æ¨¡æ¿å¼•æ“
- **pytest**: æµ‹è¯•æ¡†æ¶

## ç‰¹æ€§è¯´æ˜

### 1. èŠ‚ç‚¹æ ·å¼
- **éå¶å­èŠ‚ç‚¹**: è“è‰²åœ†è§’çŸ©å½¢
- **å¶å­èŠ‚ç‚¹**: è“è‰²åœ†å½¢
- **æ–‡æœ¬**: ç™½è‰²å­—ä½“ï¼Œæ”¯æŒè‡ªåŠ¨æ¢è¡Œ

### 2. è¿æ¥çº¿
- **æ ·å¼**: ç›´è§’è¿æ¥çº¿
- **å…³ç³»æ ‡è¯†**: AND/ORæ ‡è¯†æ˜¾ç¤ºåœ¨è¿æ¥çº¿ä¸Š

### 3. è‡ªåŠ¨å¸ƒå±€
- **å±‚çº§å¸ƒå±€**: è‡ªåŠ¨è®¡ç®—èŠ‚ç‚¹å±‚çº§
- **å±…ä¸­å¯¹é½**: çˆ¶èŠ‚ç‚¹è‡ªåŠ¨å±…ä¸­äºå­èŠ‚ç‚¹
- **é—´è·æ§åˆ¶**: åˆç†çš„èŠ‚ç‚¹é—´è·

### 4. å¯¼å‡ºåŠŸèƒ½
- **JPGæ ¼å¼**: é«˜è´¨é‡å›¾ç‰‡å¯¼å‡º
- **SVGæ ¼å¼**: çŸ¢é‡å›¾å½¢å¯¼å‡º
- **æµè§ˆå™¨ä¸‹è½½**: ç›´æ¥åœ¨æµè§ˆå™¨ä¸­ä¸‹è½½

### 5. å“åº”å¼è®¾è®¡
- **ç§»åŠ¨ç«¯é€‚é…**: æ”¯æŒæ‰‹æœºå’Œå¹³æ¿è®¿é—®
- **è‡ªé€‚åº”å¸ƒå±€**: æ ¹æ®å±å¹•å°ºå¯¸è°ƒæ•´å¸ƒå±€

## éƒ¨ç½²å»ºè®®

### å¼€å‘ç¯å¢ƒ
```bash
python run_api.py
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
uvicorn app.main:app --host 0.0.0.0 --port 8000 --workers 4
```

### Dockeréƒ¨ç½²
```dockerfile
FROM python:3.9-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .
EXPOSE 8000

CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

## è´¡çŒ®æŒ‡å—

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»ºPull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ã€‚è¯¦æƒ…è¯·å‚é˜… `LICENSE` æ–‡ä»¶ã€‚

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- æäº¤Issue: [GitHub Issues](https://github.com/your-repo/issues)
- é‚®ä»¶: your-email@example.com

---

**æ³¨æ„**: ç”Ÿæˆçš„å›¾ç‰‡æ–‡ä»¶ä¿å­˜åœ¨ `workspace/` ç›®å½•ä¸­ï¼Œè¯·ç¡®ä¿è¯¥ç›®å½•æœ‰å†™å…¥æƒé™ã€‚ 
